<html>
    <head>
<style>
html, body {
  width:  100%;
  height: 100%;
  margin: 0px;
}
</style>
        
<script src="http://cdnjs.cloudflare.com/ajax/libs/ocanvas/2.4.0/ocanvas.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
</head>
<body>
	<canvas id="canvas" width="100%" height="100%"></canvas>
	<script>
	var c = document.querySelector("#canvas"),
		ctx = c.getContext("2d");
	c.width = window.innerWidth;
	c.height = window.innerHeight;
    c.addEventListener("touchmove", function (e) { e.preventDefault(); }, false);

    var canvas = oCanvas.create({
        canvas: "#canvas",
        background: "#ccc",
        fps: 20
    });

    var image = canvas.display.image({
        width: window.innerWidth,
        height: window.innerHeight,
        image: "cnc3.jpg"
    });

    canvas.addChild(image);

    canvas.bind("click tap", function () {
        var color = Math.random() * 360;
        draw(canvas.pointer.x / image.width,
            canvas.pointer.y / image.height, color);
        $.post("../addSpot", {x: canvas.pointer.x / image.width,
            y: canvas.pointer.y / image.height,
            color: color});
    });

    function draw(x_cord, y_cord, color) {
        var arc = canvas.display.arc({
            x: x_cord * image.width,
            y: y_cord * image.height,
            radius: 25,
            start: 0,
            end: 360,
            stroke: "10px hsl(" + color + ", 50%, 50%)"
        });

        canvas.addChild(arc);

        arc.stop();
        arc.fadeOut(30000, "ease-in-out-cubic");

        return color;
    };

    $(document).ready(function(){
        $.getJSON("../getSpots",function(result){
          $.each(result, function(i, field){
              draw(field[0][0], field[0][1], field[1]);
          });
        });
    });
	</script>
</body>

</html>
